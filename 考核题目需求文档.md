# 简道云二次开发认证考核 - 题目需求文档

## 项目概述

**项目时长：** 5-7天
**考核题目：** 1、2、3、4、7（共5题）
**总分：** 58分
**前期准备：** 公共模式简道云账号（需开通API、单点登录功能）
**交卷形式：** 场景内容形成用户操作手册，并提供相关账号、密码及代码源码

---

## 题目1：热态调用简道云API（12分，3h）

### 相关知识
web服务、前端页面、简道云API

### 功能需求

#### 1. 创建基础表
在简道云上创建基础表单【用户基础表】，内容包括：
- 用户名
- 手机号
- 状态（启用/停用）

#### 2. 前端页面开发
设计一个前端页面，包括：
- 用户名输入框
- 手机号输入框
- 提交按钮：点击提交按钮后，发送请求给后端服务

#### 3. 输入校验
后端接口收到用户名和手机号码后，校验：
- **用户名：** 2-20位长度，数字、字母组成、全局唯一
- **手机号：** 11位数字、全局唯一

#### 4. 调用简道云API
校验通过后：
1. 调用简道云**通讯录API**创建简道云企业成员
2. 同时调用**数据API**写入【用户基础表】，包括手机号和用户名，状态默认"启用"

#### 5. 错误处理
- 如果输入信息不合法，需在前端反馈"输入内容不合法，请重新输入"

### 得分点
1. 完成基本功能：**6分**
2. 前端页面体验质量：**2分**
3. 非法校验：**1分**
4. 并发问题：**3分**

---

## 题目2：热态webhook（10分，2h）

### 相关知识
webhook、简道云通讯录API

### 功能需求

#### 1. 提供webhook接口
给【用户基础表】提供一个响应简道云webhook的API接口

#### 2. 判断停用状态
当服务接收到修改表的记录请求后：
1. 判断停用字段是否为【停用】
2. 如果为【停用】，则调用简道云通讯录API删除相应人员

#### 3. 数据处理流程
- 接收webhook回调请求
- 解析请求参数，获取记录信息
- 判断记录状态
- 如果状态为"停用"，调用简道云通讯录API删除对应成员

### 得分点
1. 实现基本功能：**5分**
2. 并发问题：**2.5分**
3. webhook校验：**2.5分**

---

## 题目3：数据API封装（11分，3h）

### 相关知识
前端页面、简道云数据API

### 功能需求

#### 1. 前端页面开发
开发一个前端页面：
- 输入过滤条件
- 点击"查询"按钮

#### 2. 调用简道云数据API
调用简道云的数据API（这个API一次最高只能查出1000条数据），展示查询到的表单数据（可能是单条或多条）

#### 3. 分页查询
获取到的数据部分应该在前端展示

#### 4. 数据准备
**注意：** 需要在简道云创建一个表单，并插入至少50000条数据，请保证该服务的稳定性

### 得分点
1. 实现基本功能：**5分**
2. 前端页面体验质量：**1分**
3. 后端mock数据生成代码：**1分**
4. 分页查出多条数：**3分**

---

## 题目4：简道云单点登录功能（12分，8h）

### 相关知识
web开发、简道云单点登录、前端页面

### 功能目标
做一个web服务，能够通过SSO集成到本服务，当用户在前端页面输入用户名、手机号后，校验通过后单点登录到简道云中。

### 功能需求

#### 1. 注册效果
针对首次访问的用户：
1. 提供一个注册/登录入口
2. 输入用户名和手机号，创建效果参考题目1中

#### 2. 登录效果
**首次登录流程：**
1. 用户输入账号和手机号
2. 发送webhook回调通知，跳转到简道云
3. 首次用户的webhook回调通知，返回简道云用户，然后SSO跳转到简道云
4. 如果cookie失效，则要求再次登录或者注册

**后续登录流程：**
1. webhook回调通知不再返回简道云用户
2. 用cookie识别身份信息，直接匹配简道云用户
3. 然后SSO跳转到简道云

#### 3. 安全性要求
- webhook回调有效期需验证
- 判断token有效性
- 要求每次登录验证token

### 得分点
1. 实现基本功能：**6分**
2. 安全问题：**3分**
3. 非法校验：**3分**（可以用短信验证码）

---

## 题目7：EXCEL数据流程自动处理（13分，3h）

### 场景描述
现有如下表格的EXCEL数据，名称字段空格分开，其他字段不变输出为新的excel文件

### 输入EXCEL示例

| 名称 | 字段1 | 字段2 | 字段3 | 子表字段a | 子表字段B |
|------|-------|-------|-------|-----------|-----------|
| Coop D 师花 | 红色 | 均码 | | 出资1<br>出资222<br>出货9 | 标准底校<br>合格底校<br>不合格底校<br>不规校 |
| E F | 蓝色 | XL码 | | | 标准底校 |
| K | | 大码 | | | |

### 输出EXCEL示例

| 名称 | 字段1 | 字段2 | 字段3 | 子表字段a | 子表字段B |
|------|-------|-------|-------|-----------|-----------|
| Coop | 红色 | 均码 | | 出资1<br>出资222<br>出货9 | 标准底校<br>合格底校<br>不合格底校<br>不规校 |
| D | 红色 | 均码 | | 出资1<br>出资222<br>出货9 | 标准底校<br>合格底校<br>大合格底校<br>不规校 |
| 师花 | 红色 | 均码 | | 出资1<br>出资222<br>出货9 | 标准底校<br>合格底校<br>不合格底校<br>不规校 |
| E | 蓝色 | XL码 | | | 标准底校 |
| F | 蓝色 | XL码 | | | 标准底校 |
| K | | 大码 | | | |

### 功能需求

#### 1. 在简道云中制作字段
创建表单包括：
- 输入EXCEL上传字段
- 输出EXCEL选择字段
- 输出结果显示字段

#### 2. 提交人上传处理
1. 提交人上传处理前的excel
2. 新建流程通过webhook触发后，处理excel，然后回传【输出excel】
3. 输出结果使用一个空白的（可以用API创建这个用户）用户作为机器人
4. 当收到webhook待办的时候，并且是这个账号要处理的这个excel待办，则服务可以"自动处理"这个待办

#### 3. 处理完需要服务提交流程
把结果返回给提交人确认，处理人为提交人

#### 4. Excel处理逻辑
- 读取输入Excel
- 解析"名称"字段，按空格分割
- 生成多条记录，其他字段保持不变
- 写入输出Excel
- 通过webhook回传结果

### 得分点
基本功能：**6分**

---

## 总分统计

| 题目 | 分值 | 时长 | 关键得分点 |
|------|------|------|------------|
| 题目1：API调用 | 12分 | 3h | 基本功能6分 + 页面体验2分 + 校验1分 + 并发3分 |
| 题目2：Webhook | 10分 | 2h | 基本功能5分 + 并发2.5分 + 校验2.5分 |
| 题目3：数据封装 | 11分 | 3h | 基本功能5分 + 页面1分 + mock1分 + 分页3分 |
| 题目4：单点登录 | 12分 | 8h | 基本功能6分 + 安全3分 + 校验3分 |
| 题目7：Excel处理 | 13分 | 3h | 基本功能6分 |
| **总计** | **58分** | **19h** | - |

---

## 规范性要求

1. 务必仔细阅读题目，理解题目含义，需结合现实情况进行考虑
2. 当做一个web项目来做，真实有效地完成
3. 自己没有完成的功能点，最好自己提前注明
4. 所有前端的部分，优先确保功能先实现
5. 同时会对程序稳定性、可维护性考察
6. 后端实现 java/python/go/node.js/c#等开发平台自行选用

---

## 技术要点提示

### 简道云API集成
- 通讯录API：创建/删除企业成员
- 数据API：增删改查表单数据
- Webhook：接收简道云回调通知
- SSO单点登录：实现用户身份认证

### 并发处理
- 考虑多用户同时提交的场景
- 数据库事务处理
- 接口幂等性设计

### 安全性
- Token验证
- Cookie管理
- 短信验证码（可选）
- Webhook签名验证

### 数据处理
- 大数据量分页查询（50000+条）
- Excel文件读写
- 数据格式转换
- Mock数据生成

---

**文档生成时间：** 2025-12-13
**适用版本：** 简道云二次开发认证考核
